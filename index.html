<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin BRMODS ğŸ®</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#050814;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif
}
.hidden{display:none}
.container{
  max-width:700px;
  margin:auto;
  padding:20px
}
h1,h2{
  text-align:center;
  color:#00eaff
}
input,textarea,button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:12px;
  border:none;
  font-size:15px
}
input,textarea{
  background:#0b1025;
  color:#0ff
}
textarea{
  height:180px;
  resize:none
}
button{
  background:linear-gradient(135deg,#00eaff,#1e90ff);
  font-weight:bold;
  cursor:pointer;
  color:#000
}
.log{
  margin-top:10px;
  text-align:center;
  color:#ff4444
}
.ok{color:#00ff88}
.logout{
  background:#ff0033;
  color:#fff;
  margin-top:20px
}
</style>
</head>

<body>

<!-- ğŸ” LOGIN -->
<div class="container" id="loginBox">
  <h1>ğŸ” LOGIN</h1>
  <input id="loginKey" placeholder="Ingresa tu key">
  <button id="btnLogin">ENTRAR</button>
  <div id="loginMsg" class="log"></div>
</div>

<!-- ğŸ® PANEL -->
<div class="container hidden" id="panelBox">
  <h1>ğŸ® PANEL ADMIN</h1>

  <h2>ğŸ”‘ Agregar Keys (array)</h2>
  <textarea id="keysInput" placeholder="B MODSKEY
B MODKEY
ğŸ‘¤Brmods
ğŸ”‘brmods clave"></textarea>

  <button id="btnAddKeys">AGREGAR</button>
  <div id="keysMsg" class="log ok"></div>

  <button class="logout" id="btnLogout">SALIR</button>
</div>

<script type="module">
/* ğŸ”¥ FIREBASE */
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
  getFirestore,
  doc,
  getDoc,
  updateDoc,
  arrayUnion
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

/* ğŸ”´ TU CONFIG */
const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_PROYECTO.firebaseapp.com",
  projectId: "TU_PROYECTO",
  storageBucket: "TU_PROYECTO.appspot.com",
  messagingSenderId: "ID",
  appId: "APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* REFERENCIA FIJA */
const docRef = doc(db,"claves","BRMODS_15DIAS");

/* ğŸ” LOGIN */
document.getElementById("btnLogin").addEventListener("click", async ()=>{
  const key = document.getElementById("loginKey").value.trim();
  const msg = document.getElementById("loginMsg");

  if(!key){
    msg.innerText="âŒ Ingresa una key";
    return;
  }

  try{
    const snap = await getDoc(docRef);
    if(!snap.exists()){
      msg.innerText="âŒ Documento no existe";
      return;
    }

    const lista = snap.data().lista || [];

    if(lista.includes(key)){
      loginBox.classList.add("hidden");
      panelBox.classList.remove("hidden");
      msg.innerText="";
    }else{
      msg.innerText="âŒ Key invÃ¡lida";
    }

  }catch(e){
    msg.innerText="âŒ Error Firebase";
  }
});

/* ğŸ”“ LOGOUT */
document.getElementById("btnLogout").addEventListener("click", ()=>{
  panelBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
  document.getElementById("loginKey").value="";
});

/* ğŸ”‘ AGREGAR KEYS AL ARRAY */
document.getElementById("btnAddKeys").addEventListener("click", async ()=>{
  const texto = document.getElementById("keysInput").value.trim();
  const msg = document.getElementById("keysMsg");

  if(!texto){
    msg.style.color="red";
    msg.innerText="âŒ No hay keys";
    return;
  }

  let count = 0;

  for(const l of texto.split("\n")){
    const linea = l.trim();
    if(linea){
      await updateDoc(docRef,{
        lista: arrayUnion(linea)
      });
      count++;
    }
  }

  msg.style.color="#00ff88";
  msg.innerText=`âœ… ${count} keys agregadas al array`;
  document.getElementById("keysInput").value="";
});
</script>
</body>
</html>