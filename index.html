<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîë Key Generator</title>

<style>
body{
  background:#0b0614;
  font-family:Arial, sans-serif;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card{
  background:#120a22;
  padding:25px;
  border-radius:20px;
  width:100%;
  max-width:420px;
  box-shadow:0 0 25px #7c3aed;
}

h2{
  text-align:center;
  color:#a855f7;
}

select,textarea,button{
  width:100%;
  margin-top:12px;
  padding:14px;
  border-radius:14px;
  border:none;
  background:#1e1235;
  color:white;
  font-size:15px;
}

button{
  background:linear-gradient(135deg,#7c3aed,#a855f7);
  font-weight:bold;
}

.error{
  color:#ff4d4d;
  text-align:center;
  margin-top:10px;
}

.ok{
  color:#4ade80;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="card">
  <h2>üîë Key Generator</h2>

  <select id="producto">
    <option>Cargando...</option>
  </select>

  <textarea id="keys" rows="5" placeholder="Pega las keys (1 por l√≠nea)"></textarea>

  <button onclick="guardarKeys()">‚ö° AGREGAR KEYS</button>

  <div id="msg"></div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
// üî• TU CONFIG FIREBASE (CAMBIA SOLO ESTO)
firebase.initializeApp({
  apiKey: "TU_API_KEY",
  authDomain: "TU_DOMINIO.firebaseapp.com",
  projectId: "TU_PROJECT_ID"
});

const db = firebase.firestore();
const select = document.getElementById("producto");
const msg = document.getElementById("msg");

// üöÄ CARGAR PRODUCTOS
db.collection("claves").get().then(snapshot=>{
  select.innerHTML = "<option value=''>Selecciona producto</option>";

  if(snapshot.empty){
    select.innerHTML += "<option disabled>No hay productos</option>";
    return;
  }

  snapshot.forEach(doc=>{
    const opt = document.createElement("option");
    opt.value = doc.id;
    opt.textContent = doc.id;
    select.appendChild(opt);
  });
}).catch(err=>{
  select.innerHTML = "<option>Error Firebase</option>";
  console.error(err);
});

// üíæ GUARDAR KEYS
function guardarKeys(){
  msg.innerHTML = "";

  const producto = select.value;
  const texto = document.getElementById("keys").value.trim();

  if(!producto){
    msg.innerHTML = "<div class='error'>‚ùå Selecciona un producto</div>";
    return;
  }

  if(!texto){
    msg.innerHTML = "<div class='error'>‚ùå No hay keys</div>";
    return;
  }

  const nuevas = texto.split("\n").map(k=>k.trim()).filter(k=>k);

  db.collection("claves").doc(producto).update({
    lista: firebase.firestore.FieldValue.arrayUnion(...nuevas)
  }).then(()=>{
    msg.innerHTML = "<div class='ok'>‚úÖ Keys agregadas</div>";
    document.getElementById("keys").value="";
  }).catch(e=>{
    msg.innerHTML = "<div class='error'>‚ùå Error al guardar</div>";
    console.error(e);
  });
}
</script>

</body>
</html>