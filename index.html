<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin Panel ğŸ®</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#050814;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif
}
.hidden{display:none}
.container{
  max-width:720px;
  margin:auto;
  padding:20px
}
h1,h2{
  text-align:center;
  color:#00eaff
}
input,select,textarea,button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:12px;
  border:none;
  font-size:15px
}
input,select,textarea{
  background:#0b1025;
  color:#0ff
}
textarea{
  height:180px;
  resize:none
}
button{
  background:linear-gradient(135deg,#00eaff,#1e90ff);
  font-weight:bold;
  cursor:pointer;
  color:#000
}
.producto{
  background:#0b1025;
  padding:12px;
  border-radius:12px;
  margin-top:10px
}
.log{
  margin-top:10px;
  text-align:center
}
.logout{
  background:#ff0044;
  color:#fff;
  margin-top:20px
}
</style>
</head>

<body>

<!-- ğŸ” LOGIN -->
<div class="container" id="loginBox">
  <h1>ğŸ” LOGIN ADMIN</h1>
  <input id="email" placeholder="Correo">
  <input id="password" type="password" placeholder="ContraseÃ±a">
  <button onclick="login()">ENTRAR</button>
  <div id="loginMsg" class="log"></div>
</div>

<!-- ğŸ® PANEL -->
<div class="container hidden" id="panelBox">
  <h1>ğŸ® PANEL ADMIN</h1>

  <h2>ğŸ“¦ Productos</h2>
  <select id="productosSelect"></select>
  <div id="productosLista"></div>

  <h2>ğŸ”‘ Agregar Keys</h2>
  <textarea id="keysInput" placeholder="KEY-1
KEY-2
ğŸ‘¤Brmods
ğŸ”‘brmods clave"></textarea>
  <button onclick="agregarKeys()">AGREGAR KEYS</button>
  <div id="keysMsg" class="log"></div>

  <button class="logout" onclick="logout()">CERRAR SESIÃ“N</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { 
  getAuth,
  signInWithEmailAndPassword,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

import {
  getDatabase,
  ref,
  onValue,
  push
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

/* ğŸ”´ TU FIREBASE CONFIG ğŸ”´ */
const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_DOMINIO.firebaseapp.com",
  databaseURL: "https://TU_PROYECTO.firebaseio.com",
  projectId: "TU_PROYECTO",
  storageBucket: "TU_PROYECTO.appspot.com",
  messagingSenderId: "ID",
  appId: "APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

/* ğŸ” LOGIN */
window.login = function(){
  const email = email.value;
  const pass = password.value;

  signInWithEmailAndPassword(auth,email,pass)
    .catch(err=>{
      loginMsg.style.color="red";
      loginMsg.innerText=err.message;
    });
};

/* ğŸ”“ LOGOUT */
window.logout = function(){
  signOut(auth);
};

/* ğŸ‘ï¸ CONTROL SESIÃ“N */
onAuthStateChanged(auth,user=>{
  if(user){
    loginBox.classList.add("hidden");
    panelBox.classList.remove("hidden");
    cargarProductos();
  }else{
    panelBox.classList.add("hidden");
    loginBox.classList.remove("hidden");
  }
});

/* ğŸ“¦ PRODUCTOS */
function cargarProductos(){
  const productosRef = ref(db,"productos"); // ğŸ‘ˆ CAMBIA SOLO SI TU NODO ES OTRO

  onValue(productosRef,snap=>{
    productosSelect.innerHTML="";
    productosLista.innerHTML="";

    if(!snap.exists()){
      productosSelect.innerHTML="<option>No hay productos</option>";
      return;
    }

    snap.forEach(p=>{
      const d = p.val();

      const opt = document.createElement("option");
      opt.textContent = `${d.nombre} - S/ ${d.precio}`;
      productosSelect.appendChild(opt);

      const div = document.createElement("div");
      div.className="producto";
      div.innerHTML=`
        ğŸ® <b>${d.nombre}</b><br>
        ğŸ’° Precio: ${d.precio}<br>
        â³ DÃ­as: ${d.dias}
      `;
      productosLista.appendChild(div);
    });
  });
}

/* ğŸ”‘ AGREGAR KEYS */
window.agregarKeys = function(){
  const texto = keysInput.value.trim();
  if(!texto){
    keysMsg.style.color="red";
    keysMsg.innerText="âŒ No hay keys";
    return;
  }

  const lineas = texto.split("\n");
  let count=0;

  lineas.forEach(l=>{
    const linea = l.trim();
    if(linea){
      push(ref(db,"lista"),{
        value: linea,
        used:false,
        created: Date.now()
      });
      count++;
    }
  });

  keysMsg.style.color="#0f0";
  keysMsg.innerText=`âœ… ${count} keys agregadas`;
  keysInput.value="";
};
</script>
</body>
</html>